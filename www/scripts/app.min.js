$(document).ready(function(){$("#StudentCount").keypress(function(e){"13"==e.keyCode&&e.preventDefault()})});var app=angular.module("IC",["firebase","ngAnimate","ngRoute","ngTouch","angular-loading-bar","hue","angularResizable","ngDragDrop"]),config={apiKey:"AIzaSyBpdRvCW0oJH5ukKNWBZp3jipGVg8w0wyE",authDomain:"interactiveclassroom.firebaseapp.com",databaseURL:"https://interactiveclassroom.firebaseio.com",storageBucket:"project-3354574417935505015.appspot.com"};firebase.initializeApp(config),app.factory("fbRef",[function(){var e=firebase.database().ref();return e}]),app.factory("Auth",["$firebaseAuth",function(e){return e()}]),app.directive("myEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.myEnter)}),t.preventDefault())})}}),app.directive("myResize",["$window",function(e){return function(t,n,r){angular.element(e).bind("resize",function(){t.$apply(function(){t.$eval(r.gothing)})})}}]),angular.module("IC").run(["$rootScope","$location",function(e,t){e.$on("$routeChangeError",function(e,n,r,o){"AUTH_REQUIRED"===o&&t.path("/")})}]),angular.module("IC").config(["$routeProvider",function(e){e.when("/class:classid",{controller:"Student",templateUrl:"/views/student.html",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]}}).when("/dashboard:classid",{controller:"Teacher",templateUrl:"/views/teacher.html",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]}}).when("/",{templateUrl:"/views/home.html",controller:"Home"}).when("/:action",{templateUrl:"/views/home.html",controller:"Home"}).otherwise({redirectTo:"/"})}]),angular.module("IC").controller("Home",["$scope","$firebaseObject","$firebaseArray","$timeout","$location","$rootScope","$routeParams","cfpLoadingBar","fbRef",function(e,t,n,r,o,s,i,a,u){var c=u;if(e.btngrpclass="",e.invitecode="",e.labeltext="",e.addingClass=!1,e.joinBtn=!1,e.cancel=function(){e.btngrpclass="",e.invitecode="",e.addingClass=!1,e.joinBtn=!1},void 0!=i.action){var l=i.action.substring(1);switch(l){case"logout":s.$broadcast("logout")}}e.userData={},a.start(),e.$on("userGuid",function(n,o){void 0==o||null==o?(e.userData={},e.cancel(),a.complete()):(e.userData=t(c.child("Users").child(o).child("User")),e.userData.$loaded(function(){if(void 0!=i.action){var t=i.action.substring(1);isNaN(t)||e.joinClass(t)}e.joinBtn?(e.btngrpclass="homebtngrp--loggedin",e.invitecode="Welcome "+e.userData.name.split(" ")[0]+"!",r(function(){e.invitecode="",e.labeltext=e.labelText(),e.btngrpclass="homebtngrp--invitecode",setTimeout(function(){$(".homebtngrp-left-input").focus()},500)},2e3)):e.cancel(),a.complete()}))}),s.$broadcast("userGuidReq"),e.classroom=function(t){e.addingClass=t,void 0==e.userData.uid?(e.btngrpclass="homebtngrp--login",e.joinBtn=!0,s.$broadcast("login")):(e.labeltext=e.labelText(),e.btngrpclass="homebtngrp--invitecode",setTimeout(function(){$(".homebtngrp-left-input").focus()},500))},e.labelText=function(){return e.addingClass?"Name your new class.":"Please enter your invite code."},e.secondary=function(){switch(e.btngrpclass){case"homebtngrp--login":s.$broadcast("login");break;case"homebtngrp--loggedin":break;case"homebtngrp--invitecode":e.addingClass?e.createClass():e.joinClass(e.invitecode);break;default:e.classroom(!0)}},e.createClass=function(){var r=n(c.child("Users").child(e.userData.uid).child("Classes").child("Teaches"));r.$add({Date:""}).then(function(n){var s=n.path.o[n.path.o.length-1],i=t(c.child("Classes").child(s));i.Pub={CurrentLesson:null,CurrentTopic:null,Name:e.invitecode,Teacher:e.userData.uid},i.$save().then(function(e){var t=r.$indexFor(s);r[t].Date=Date.now(),r.$save(t).then(function(){o.path("/dashboard:"+s)})})})},e.joinClass=function(n){if(void 0!=n&&""!=n&&n.length>3){var r=t(c.child("Joiners").child(n).child("Date"));r.$loaded(function(){if(void 0!=r.$value&&r.$value>Date.now()-36e5){console.log(n);var s=t(c.child("Joiners").child(n).child("ClassUid"));s.$loaded().then(function(){if(void 0!=s.$value){var r=t(c.child("Users").child(e.userData.uid).child("Classes").child("Partakes").child(s.$value));r.$loaded(function(){void 0==r.Date?(r.Date=Date(),r.ReferJoiner=n,r.$save().then(function(){o.path("/class:"+s.$value)})):o.path("/class:"+s.$value)})}})}})}}}]),angular.module("IC").controller("Student",["$scope","$firebaseObject","$firebaseArray","$routeParams","$interval","$rootScope","cfpLoadingBar","fbRef","$location",function(e,t,n,r,o,s,i,a,u){var c=a;e.classid=r.classid.substring(1),e.currentAnswer={};var l={};i.start(),e.$on("userGuid",function(n,r){void 0==r||null==r?e.userData={}:(e.userData=t(c.child("Users").child(r).child("User")),e.userData.$loaded(function(){e.classInfo=t(c.child("Classes").child(e.classid).child("/Pub")),e.classInfo.$loaded(function(){i.complete()})}))}),s.$broadcast("userGuidReq"),l=o(function(){void 0!=e.myHeartbeat&&(e.myHeartbeat.Date=Date.now(),e.myHeartbeat.$save())},3e4),e.$on("$destroy",function(){o.cancel(l)}),e.$watch("classInfo.CurrentLesson",function(n,r){void 0!=n&&((void 0!=e.classInfo.CurrentLesson.Date&&e.classInfo.CurrentLesson.Date<=Date.now()-36e5||e.classInfo.CurrentLesson.Completed)&&u.path("/"),e.lessonRef=c.child("Classes").child(e.classid).child("Lessons").child(e.classInfo.CurrentLesson.uid),e.myHeartbeat=t(e.lessonRef.child("Students").child(e.userData.uid)),e.myHeartbeat.Date=Date.now(),void 0!=e.userData.profileImageURL&&(e.myHeartbeat.ProfilePicture=e.userData.profileImageURL),e.myHeartbeat.$save())}),e.updateCurrentTopic=function(){e.currentAnswer=t(e.lessonRef.child("Topics").child(e.classInfo.CurrentTopic.uid).child("Answers").child(e.userData.uid)),e.currentAnswer.$loaded(function(){void 0==e.currentAnswer.Answer&&e.answer(1)})},e.$watch("classInfo.CurrentTopic",function(t,n){void 0!=t&&e.updateCurrentTopic()}),e.getLeft=function(){switch(e.currentAnswer.Answer){case 0:return 66.666;case 2:return 0;default:return 33.333}},e.swipeAnswer=function(t){t&&e.currentAnswer.Answer<2?e.answer(e.currentAnswer.Answer+1):!t&&e.currentAnswer.Answer>0&&e.answer(e.currentAnswer.Answer-1)},e.answer=function(t){e.currentAnswer.Answer=t,e.currentAnswer.Date=Date(),e.currentAnswer.$save()}}]),angular.module("IC").controller("Teacher",["$scope","$firebaseObject","$firebaseArray","$routeParams","$rootScope","hue","fbRef","$interval","$timeout","cfpLoadingBar","$location",function(e,t,n,r,o,s,i,a,u,c,l){var d=i;e.classid=r.classid.substring(1);var f=d.child("Classes").child(e.classid),h=s;h.setup({username:"SzDOKancs7zL7Vubik2dn3MAqJJ8QU46iRZa7qpB",bridgeIP:"172.16.11.40",debug:!0}),h.getLights().then(function(t){e.lights=t,h.setLightState(1,{on:!0}).then(function(e){})}),e.convertRGBtoXY=function(e,t,n){e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var r=.664511*e+.154324*t+.162028*n,o=.283881*e+.668433*t+.047685*n,s=88e-6*e+.07231*t+.986039*n,i=r/(r+o+s),a=o/(r+o+s);return isNaN(i)&&(i=0),isNaN(a)&&(a=0),[i,a]},e.setHueColor=function(t,n,r){var o=!0;0>=t&&0>=n&&0>=r&&(o=!1);var s=e.convertRGBtoXY(t,n,r);h.setLightState(1,{on:o,bri:254,xy:s,transitiontime:0}).then(function(e){console.log("API response: ",e)})},c.start(),e.$on("userGuid",function(r,o){void 0==o||null==o?(e.userData={},e.colorsLive={},e.colors={},e.classPub={}):(e.userData={},e.colorsLive={},e.colors={},e.classPub={},e.userData=t(d.child("Users").child(o).child("User")),e.colorsLive=t(d.child("Users").child(o).child("Colors")),e.colorsLive.$loaded(function(){console.log(e.colorsLive),null==e.colorsLive.$value&&(e.colorsLive.$value=[{color:"Violet",perc:10},{color:"RoyalBlue",perc:50},{color:"Green",perc:20},{color:"Aqua",perc:20}],e.colorsLive.$save())}),e.colorsLive.$watch(function(t){var n=new Array;e.colorsLiveLength=0,angular.forEach(e.colorsLive,function(t,r){e.colorsLiveLength+=1,void 0==e.colors[r]||e.colors[r].color==t.color&&e.colors[r].perc==t.perc||(e.colors[r].color=t.color,e.colors[r].perc=t.perc),n.push(angular.extend({},t))}),e.colors.length!=e.colorsLiveLength&&(e.colors=n),e.findFlexBasis()}),e.classPub=t(f.child("/Pub")),e.classPub.$loaded(function(){if(void 0!=e.classPub.CurrentLesson&&e.classPub.CurrentLesson.Completed&&(e.classPub.CurrentLesson.Completed=!1,e.classPub.$save()),void 0==e.classPub.CurrentLesson||""==e.classPub.CurrentLesson.uid||e.classPub.CurrentLesson.Date<=Date.now()-36e5){void 0==e.classPub.CurrentLesson&&(e.classPub.CurrentLesson={}),void 0==e.classPub.CurrentTopic&&(e.classPub.CurrentTopic={});var t=n(f.child("Lessons")),r=Date.now();t.$add({Date:r}).then(function(t){e.classPub.CurrentLesson.uid=t.key,e.classPub.CurrentLesson.Date=r;var o=n(f.child("Lessons").child(t.key).child("Topics")),s=Date.now();o.$add({Date:s}).then(function(t){e.classPub.CurrentTopic.uid=t.key,e.classPub.CurrentTopic.Date=s,e.classPub.$save()})})}c.complete()}))}),o.$broadcast("userGuidReq"),e.createNewTopic=function(){if(""!=e.classPub.CurrentLesson.uid){void 0==e.classPub.CurrentTopic&&(e.classPub.CurrentTopic={});var t=n(f.child("Lessons").child(e.classPub.CurrentLesson.uid).child("Topics")),r=Date.now();t.$add({Date:r}).then(function(t){e.classPub.CurrentTopic.uid=t.key,e.classPub.CurrentTopic.Date=r,e.classPub.$save()})}},e.closeOffLesson=function(){void 0!=e.classPub.CurrentLesson&&(e.classPub.CurrentLesson.Completed=!0,e.classPub.$save().then(function(){l.path("/")}))};var p=a(function(){e.updateActiveStudents()},3e4);e.$on("$destroy",function(){a.cancel(p)}),e.updateActiveStudents=function(){if(void 0!=e.Students&&void 0!=e.Students.List){var t=0;angular.forEach(e.Students.List,function(n){var r=e.Students.ActiveList.indexOf(n);n.Date>=Date.now()-7e4?(t+=1,0>r&&e.Students.ActiveList.push(n)):r>=0&&e.Students.ActiveList.splice(r,1)}),e.Students.StudentTotal=t,e.updateTopicAnswers()}},e.$watch("Students.List",function(t,n){e.updateActiveStudents()},!0),e.$watch("classPub.CurrentLesson",function(t,r){void 0!=t&&void 0!=t.uid?(void 0==r||t!=r||t===r)&&(console.log("Update Lesson"),console.log(t),void 0==e.Students&&(e.Students={}),e.Students.ActiveList=new Array,e.Students.List=n(f.child("Lessons").child(t.uid).child("Students"))):(console.log("Destory students"),e.Students={})}),e.$watch("classPub.CurrentTopic",function(n,r){void 0!=n&&void 0!=n.uid?(void 0==r||n!=r||n===r)&&(console.log("Update Topic"),console.log(n),e.Topic=t(f.child("Lessons").child(e.classPub.CurrentLesson.uid).child("Topics").child(n.uid))):(console.log("Destory topic"),e.Topic={})}),e.updateTopicAnswers=function(){if(void 0!=e.Answers){e.Answers.Total=0,e.Answers.zero=0,e.Answers.one=0,e.Answers.two=0,void 0!=e.Topic.Answers&&angular.forEach(e.Students.ActiveList,function(t){void 0!=e.Topic.Answers[t.$id]&&(e.Answers.Total+=1,e.Topic.Answers[t.$id].Answer<1?(t.Answer=0,e.Answers.zero+=1):e.Topic.Answers[t.$id].Answer<2?(t.Answer=1,e.Answers.one+=1):e.Topic.Answers[t.$id].Answer<3&&(t.Answer=2,e.Answers.two+=1))});var t=0;e.Students.StudentTotal>0&&(t=100/(e.Students.StudentTotal/e.Answers.two)),e.Answers.Perc!=t&&(e.Answers.Perc=t,e.findColor())}else e.Answers={Perc:0}},e.$watch("Topic.Answers",function(t,n){e.updateTopicAnswers()}),e.pluralsAreGoodIGuess=function(e){return e>1||0==e?"s":void 0},e.areAndIsAreWeird=function(e){return e>1||0==e?"are":"is"},e.generateInviteLoop=function(n){var r=t(d.child("Joiners").child(n).child("Date"));r.$loaded().then(function(){if(void 0==r.$value||r.$value<=Date.now()-36e5){console.log("Create the joiner at "+n);var o=t(d.child("Joiners").child(n).child("ClassUid"));o.$value=e.classid,o.$save().then(function(){r.$value=Date.now(),r.$save()}),e.generatedInvite=n}else e.generateInviteIterate()})},e.generateInviteIterate=function(){if(e.generateInviteIterateRetries<5){var t=Math.floor(1e3+9e3*Math.random());e.generateInviteLoop(t),e.generateInviteIterateRetries++}},e.generateInviteCode=function(){e.generatedInvite="",e.generateInviteIterateRetries=0,e.generateInviteIterate()},e.getInviteLink=function(){return e.generatedInvite?location.protocol+"//"+location.host+"/#/:"+e.generatedInvite:""},e.colors=new Array,e.avalicolors=["RoyalBlue","Aqua","Green","Yellow","Orange","Red","Fuchsia","Violet","Lavender","Transparent"],e.removeColor="REMOVE",e.$watch("colors",function(n,r){if(void 0!=n){angular.forEach(n,function(t,n){(void 0==e.colorsLive[n]||e.colorsLive[n].color!=t.color||e.colorsLive[n].perc!=t.perc)&&(e.colorsLive[n]=t,e.colorsLive.$save())});var o=n.length;angular.forEach(e.colorsLive,function(n,r){r>=o&&t(e.colorsLive.$ref().child(r)).$remove()}),u(function(){e.findColor()},600)}},!0),e.draggingColor=!1,e.draggingColorStart=function(){e.$apply(function(){e.draggingColor=!0})},e.draggingColorStop=function(){e.$apply(function(){e.draggingColor=!1})},e.draggingColorRemove=!1,e.draggingColorRemoveStart=function(){e.$apply(function(){e.draggingColorRemove=!0})},e.draggingColorRemoveStop=function(){e.$apply(function(){e.draggingColorRemove=!1})},e.dropColorHoverOver=function(e){angular.element(e.target).addClass("colorbarcolorhover")},e.dropColorHoverOut=function(e){angular.element(e.target).removeClass("colorbarcolorhover")},e.colorbaradd={},e.droppedColor=function(t){angular.element(t.target).removeClass("colorbarcolorhover"),console.log(t),e.draggingColorRemove&&(angular.forEach(e.colors,function(t,n){"REMOVE"==t.color&&e.colors.splice(n,1)}),e.findFlexBasis()),e.colorbaradd!={}&&(void 0!=e.colorbaradd.left&&""!=e.colorbaradd.left&&e.colors.splice(0,0,{color:e.colorbaradd.left}),void 0!=e.colorbaradd.right&&""!=e.colorbaradd.right&&e.colors.push({color:e.colorbaradd.right}),e.colorbaradd={},e.findFlexBasis())},e.recalcColor=function(){var t=$(".colorbar").width(),n=0;angular.forEach(e.colors,function(e,r){var o=$("#color-"+r).outerWidth(!0)/t*100;n+=o,e.perc=o})},e.findColor=function(){$(document).ready(function(){var t="bgc-gray",n=0;return angular.forEach(e.colors,function(r,o){if(n<=e.Answers.Perc&&n+r.perc>e.Answers.Perc){t="bglc-"+r.color;var s=$("#color-"+o).css("color"),i=/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/,a=i.exec(s);null!==a&&e.setHueColor(a[1],a[2],a[3])}n+=r.perc}),t})},e.findFlexBasis=function(){$(document).ready(function(){var t=$("#color-0").outerWidth()-$("#color-0").width();angular.forEach(e.colors,function(n,r){if(r<e.colors.length-1){var o=$(".colorbar").width(),s=o*(n.perc/100)-t;$("#color-"+r).css("flexBasis",s)}})})}}]),angular.module("IC").controller("Nav",["$scope","$firebaseObject","$firebaseArray","Auth","$timeout","$location","$rootScope","fbRef",function(e,t,n,r,o,s,i,a){var u=a;i.userData={},r.$onAuthStateChanged(function(e){null!=e?(i.userData=t(u.child("Users").child(e.uid).child("User")),i.userData.$loaded(function(){i.userData.uid=e.uid,i.userData.email=e.providerData[0].email,i.userData.name=e.providerData[0].displayName,i.userData.profileImageURL=e.providerData[0].photoURL,i.userData.LastLogin=Date(),i.userData.$save().then(function(){i.$broadcast("userGuid",i.userData.uid)})}),i.classData=t(u.child("Users").child(e.uid).child("Classes"))):(i.userData={},i.$broadcast("userGuid",void 0))}),e.$on("userGuidReq",function(e){i.$broadcast("userGuid",i.userData.uid)}),e.$watch("userData.uid",function(e,t){void 0==e&&r.$getAuth(),console.log("watchauth: "+e)}),e.$on("login",function(){var e=new firebase.auth.GoogleAuthProvider;e.addScope("email"),e.addScope("profile"),r.$signInWithPopup(e).then(function(e){})["catch"](function(t){"TRANSPORT_UNAVAILABLE"===t.code?r.$signInWithRedirect(e).then(function(e){}):i.$broadcast("userGuidHome",null)})}),e.$on("logout",function(){r.$signOut(),i.userData={},s.path("/")}),e.nav=!1,e.showNav=function(){return void 0==i.userData.uid?!1:!0},e.navitemsdef=new Array({icon:"replay",link:"#/",fb:{Name:"Home"},right:!0},{icon:"highlight_off",link:"#/:logout",fb:{Name:"Log off"}}),e.navitems=new Array,e.navitemspartakes=new Array,e.navitemsteaches=new Array,e.itemsUpdate=function(){var t=[e.navitemspartakes,e.navitemsteaches,e.navitemsdef];e.navitems=[],angular.forEach(t,function(t){angular.forEach(t,function(t){e.navitems.push(t)})}),e.nav&&(e.items=e.navitems)},e.$watch("classData.Partakes",function(n,r){e.navitemspartakes=new Array,void 0!=n&&null!=n?angular.forEach(n,function(n,r){var o=t(u.child("Classes").child(r).child("Pub"));o.$loaded(function(){var t=!1;""!=o.CurrentLesson&&(t=!0),e.navitemspartakes.push({icon:"face",link:"#/class:"+r,active:t,fb:o}),e.itemsUpdate()})}):e.itemsUpdate()}),e.$watch("classData.Teaches",function(n,r){e.navitemsteaches=new Array,void 0!=n&&null!=n?angular.forEach(n,function(n,r){if(void 0!=n.Date&&""!=n.Date){var o=t(u.child("Classes").child(r).child("Pub"));o.$loaded(function(){var t=!1;""!=o.CurrentLesson&&(t=!0),e.navitemsteaches.push({icon:"stars",link:"#/dashboard:"+r,active:t,fb:o}),e.itemsUpdate()})}}):e.itemsUpdate()}),e.navItemClass=function(e){var t="";return e.right&&(t+="navitemright "),void 0!=e.fb.CurrentLesson&&(t+=void 0!=e.fb.CurrentLesson.Date&&e.fb.CurrentLesson.Date<=Date.now()-36e5||e.fb.CurrentLesson.Completed?"naviteminactive ":"navitemactive "),t},e.toggle=function(){e.items=new Array,e.nav||(e.items=e.navitems),e.nav=!e.nav}}]),angular.module("hue",[]).service("hue",["$http","$q","$log",function(e,t,n){var r,o,s,i,a,u,c,l,d,f,h,p;o={username:"",apiUrl:"",bridgeIP:""},i=!1,p=function(){var e;return e=t.defer(),i?(e.resolve(),e.promise):""===o.username?(n.error("Error in setup: Username has to be set"),e.reject,e.promise):""!==o.apiUrl?(i=!0,e.resolve(),e.promise):(""!==o.bridgeIP?(o.apiUrl=r(),i=!0,e.resolve()):s().then(function(t){return null!=t[0]?(o.bridgeIP=t[0].internalipaddress,o.apiUrl=r(),i=!0,e.resolve()):(n.error("Error in setup: Returned data from nupnp is empty. Is there a hue bridge present in this network?"),e.reject)},function(t){return n.error("Error in setup: "+t),e.reject}),e.promise)},f=function(r,o,s){var i;return i=t.defer(),e.put(o,s).success(function(e){return h(r,e,i)}).error(function(e){return n.error("Error: "+r,e),i.reject}),i.promise},d=function(r,o,s){var i;return i=t.defer(),e.post(o,s).success(function(e){return h(r,e,i)}).error(function(e){return n.error("Error: "+r,e),i.reject}),i.promise},c=function(r,o){var s;return s=t.defer(),e["delete"](o).success(function(e){return h(r,e,s)}).error(function(e){return n.error("Error: "+r,e),s.reject}),s.promise},l=function(r,o){var s;return s=t.defer(),e.get(o).success(function(e){return h(r,e,s)}).error(function(e){return n.error(""+r,e),s.reject}),s.promise},h=function(e,t,r){return null!=t[0]&&t[0].error?(n.error(""+e,t),r.reject):(n.debug("Response of "+e+":",t),r.resolve(t))},u=function(e){var t,n,r,s;for(null==e&&(e=[]),n=o.apiUrl,r=0,s=e.length;s>r;r++)t=e[r],n+="/"+t;return n},a=function(e,t,r){var o,s;switch(null==t&&(t=[]),null==r&&(r=null),o=e+t.join("/"),s=u(t),e){case"get":return l(o,s);case"post":return d(o,s,r);case"put":return f(o,s,r);case"delete":return c(o,s);default:return n.error("unsupported method "+e)}},s=function(){return l("getBridgeNupnp","https://www.meethue.com/api/nupnp")},r=function(){return"http://"+o.bridgeIP+"/api/"+o.username},this.getBridgeIP=function(){return p().then(function(){return o.bridgeIP})},this.setup=function(e){return null==e&&(e={}),angular.extend(o,e)},this.getLights=function(){return p().then(function(){return a("get",["lights"])})},this.getNewLights=function(){return p().then(function(){return a("get",["lights","new"])})},this.searchNewLights=function(){return p().then(function(){return a("post",["lights"],{})})},this.getLight=function(e){return p().then(function(){return a("get",["lights",e])})},this.setLightName=function(e,t){return p().then(function(){return a("put",["lights",e],{name:t})})},this.setLightState=function(e,t){return p().then(function(){return a("put",["lights",e,"state"],t)})},this.getConfiguration=function(){return p().then(function(){return a("get",["config"])})},this.setConfiguration=function(e){return p().then(function(){return a("put",["config"],e)})},this.createUser=function(e,t){return null==t&&(t=!1),p().then(function(){var n;return n={devicetype:e},t&&(n.username=t),a("post",["api"],n)})},this.deleteUser=function(e){return p().then(function(){return a("delete",["config","whitelist",e])})},this.getFullState=function(){return p().then(function(){return a("get")})},this.getGroups=function(){return p().then(function(){return a("get",["groups"])})},this.createGroup=function(e,t){return p().then(function(){var r;return r={lights:t,name:e},n.debug("Debug: createGroup body",r),a("post",["groups"],r)})},this.getGroupAttributes=function(e){return p().then(function(){return a("get",["groups",e])})},this.setGroupAttributes=function(e,t,n){return p().then(function(){var r;return r={lights:n,name:t},a("put",["groups",e],r)})},this.setGroupState=function(e,t){return p().then(function(){return a("put",["groups",e,"action"],t)})},this.deleteGroup=function(e){return p().then(function(){return a("delete",["groups",e])})},this.getRules=function(){return p().then(function(){return a("get",["rules"])})},this.getRule=function(e){return p().then(function(){return a("get",["rules",e])})},this.createRule=function(e,t,n){return p().then(function(){var r;return r={name:e,conditions:t,actions:n},a("post",["rules"],r)})},this.updateRule=function(e,t,r,o){return null==t&&(t=!1),null==r&&(r=!1),null==o&&(o=!1),p().then(function(){var e;return e={},t&&(e.name=t),r&&(e.conditions=r),o&&(e.actions=o),n.debug("Debug: updateRule body",e),a("put",["rules"],e)})},this.deleteRule=function(e){return p().then(function(){return a("delete",["rules",e])})},this.getSchedules=function(){return p().then(function(){return a("get",["schedules"])})},this.createSchedule=function(e,t,n,r,o,s){return null==e&&(e="schedule"),null==t&&(t=""),null==o&&(o="enabled"),null==s&&(s=!1),p().then(function(){var i;return i={name:e,description:t,command:n,time:r,status:o,autodelete:s},a("post",["schedules"],i)})},this.getScheduleAttributes=function(e){return p().then(function(){return a("get",["schedules",e])})},this.setScheduleAttributes=function(e,t,n,r,o,s,i){return null==t&&(t=null),null==n&&(n=null),null==r&&(r=null),null==o&&(o=null),null==s&&(s=null),null==i&&(i=null),p().then(function(){var o;return o={},t&&(o.name=t),n&&(o.description=n),r&&(o.command=r),s&&(o.status=s),null!==i&&(o.autodelete=i),a("put",["schedules",e],o)})},this.deleteSchedule=function(e){return p().then(function(){return a("delete",["schedules",e])})},this.getScenes=function(){return p().then(function(){return a("get",["scenes"])})},this.createScene=function(e,t,n){return p().then(function(){var r;return r={name:t,lights:n},a("put",["scenes",e],r)})},this.updateScene=function(e,t,n){return p().then(function(){return a("put",["scenes",e,"lights",t,"state"],n)})},this.getSensors=function(){return p().then(function(){return a("get",["sensors"])})},this.createSensor=function(e,t,n,r,o,s,i,u){return null==i&&(i=null),null==u&&(u=null),p().then(function(){var c;return c={name:e,modelid:t,swversion:n,type:r,uniqueid:o,manufacturername:s},i&&(c.state=i),u&&(c.config=u),a("post",["sensors"],c)})},this.searchNewSensors=function(){return p().then(function(){return a("post",["sensors"],null)})},this.getNewSensors=function(){return p().then(function(){return a("get",["sensors","new"])})},this.getSensor=function(e){return p().then(function(){return a("get",["sensors",e])})},this.renameSensor=function(e,t){return p().then(function(){var n;return n={name:t},a("put",["sensors",e],n)})},this.updateSensor=function(e,t){return p().then(function(){return a("put",["sensors",e,"config"],t)})},this.setSensorState=function(e,t){return p().then(function(){return a("put",["sensors",e,"state"],t)})},this.getTimezones=function(){return p().then(function(){return a("get",["info","timezones"])})},this.setEffect=function(e){return function(t,n){return null==n&&(n="none"),e.setLightState(t,{effect:n})}}(this),this.setAlert=function(e){return function(t,n){return null==n&&(n="none"),e.setLightState(t,{alert:n})}}(this),this.setBrightness=function(e){return function(t,n){return e.setLightState(t,{bri:n})}}(this)}]);